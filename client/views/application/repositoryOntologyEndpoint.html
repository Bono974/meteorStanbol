<template name="repositoryOnto">

<div>
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">ServOWeb 2</a>
            </div>

            <center>
                <div class="collapse navbar-collapse" id="navbar-main">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="#"> Ontology repository <span class="sr-only">(current)</span></a></li>
                        <li><a href="./repositoryRessource">Ressource enhancement</a></li>
                        <li><a href="./servomap">Alignment process</a></li>
                        <li><a href="./visualisation">Visualization</a></li>
                    </ul>
                    <form class="navbar-form navbar-right" role="search">
                        <div class="form-group">
                            <input type="text" class="form-control" name="username" placeholder="Username">
                        </div>
                        <div class="form-group">
                            <input type="password" class="form-control" name="password" placeholder="Password">
                        </div>
                        <button type="submit" class="btn btn-default">Sign in</button>
                    </form>
                </div><!-- /.navbar-collapse -->
            </center>
        </div><!-- /.container-fluid -->
    </nav>

  <!-- Nav tabs -->
  <ul class="nav nav-tabs" role="tablist">
    <li role="presentation" class="active"><a href="#Overview" aria-controls="Overview" role="tab" data-toggle="tab">Overview</a></li>
    <li role="presentation"><a href="#EntityViewer" aria-controls="EntityViewer" role="tab" data-toggle="tab">EntityViewer</a></li>
    <li role="presentation"><a href="#MappingViewer" aria-controls="MappingViewer" role="tab" data-toggle="tab">MappingViewer</a></li>
    <li role="presentation"><a href="#AdminViewer" aria-controls="AdminViewer" role="tab" data-toggle="tab">Administration</a></li>
  </ul>

  <!-- Tab panes -->
  <div class="tab-content">
      <div role="tabpanel" class="tab-pane active" id="Overview">
          <br/>
          <div class="row">
              <div class="col-md-4">
                  <div class="panel panel-default">
                      <div class="panel-heading"> Ontologies </div>
                      <div class="panel-body">
                          <select multiple class="form-control">
                              {{#each listOntos}}
                              <option value={{.}}> {{.}} </option>
                              {{/each}}
                          </select>
                      </div>
                  </div>
                  <div class="panel panel-default">
                      <div class="panel-heading"> Entity : {{currentEntityLabel}} </div>
                      <div class="panel-body">
                          URI : {{currentEntity}} <br/>
                          <br/>
                          <table class="table table-striped table-condensed table-hover table-bordered">
                              <thead>
                                  <th>Available predicates</th>
                              </thead>
                              <tbody>
                                 {{#each currentEntityPredicates}}
                                 <!--<tr><a href="./repositoryOnto?currentEntity={{escapeEntity currentEntity}}&currentPredicate={{escapeEntity predicate}}">{{predicate}}</a></tr>-->
                                 <tr><a href="./repositoryOnto?currentEntity={{escapeEntity predicate}}">{{predicate}}</a></tr>
                                 {{/each}}
                                 <!-- TODO : show result "currentEntity predicate ?object" -->
                              </tbody>
                          </table>
                          <table class="table table-striped table-condensed table-hover table-bordered">
                              <thead>
                                  <th>Available mappings</th>
                              </thead>
                              <tbody>
                                 {{#each currentEntityMappings}}
                                 <tr><a href="./repositoryOnto?currentEntity={{escapeEntity mapping}}">{{mapping}}</a></tr>
                                 {{/each}}
                                 <!-- TODO : show result "currentEntity ?alignment mappings" -->
                              </tbody>
                          </table>
                      </div>
                  </div>
              </div>
              <div class="col-md-6">
                  <div class="panel panel-default">
                      <div class="panel-heading"> SPARQL Query </div>
                      <div class="panel-body">
                          {{>EditorPage}}
                          <center><br/><button type="button" class="btn btn-default" value="runQuery"> Run </button></center>
                      </div>
                  </div>
                  <div class="panel panel-default">
                      <div class="panel-heading"> Results </div>
                      <div class="panel-body">
                          <table class="table table-striped table-condensed table-hover table-bordered">
                              <thead>
                                  {{#each headerResultQuery}}
                                  <th>{{header}}</th>
                                  {{/each}}
                              </thead>
                              <tbody>
                                    {{#each rowResultQuery}}
                                <tr>
                                    {{#each resultMap res}}
                                     <td><a href="./repositoryOnto?currentEntity={{escapeEntity .}}">{{.}}</a></td>
                                    {{/each}}
                                </tr>
                                    {{/each}}
                              </tbody>
                          </table>
                          <ul class="pager">
                              <li class="previousResults"><a href="#">&larr; Previous</a></li>
                              <li class="nextResults"><a href="#">Next &rarr;</a></li>
                          </ul>
                      </div>
                  </div>
              </div>
          </div>
      </div>

      <div role="tabpanel" class="tab-pane" id="EntityViewer">
          <br/>
          <div class="panel panel-default">
              <div class="panel-heading"> [{{currentEntityLabel}}] : {{currentEntity}}
              </div>
              <div class="panel-body">
                  <table class="table table-striped table-condensed table-hover table-bordered">
                      <thead>
                          <th>predicate</th>
                          <th>object</th>
                      </thead>
                      <tbody>
                      {{#each rowResultQueryEntityRight}}
                      <tr>
                          {{#each res}}
                          <td><a href="./repositoryOnto?currentEntity={{escapeEntity .}}">{{.}}</a></td>
                          {{/each}}
                      </tr>
                      {{/each}}
                      </tbody>
                  </table>
                  <table class="table table-striped table-condensed table-hover table-bordered">
                      <thead>
                          <th>subject</th>
                          <th>predicate</th>
                      </thead>
                      <tbody>
                      {{#each rowResultQueryEntityLeft}}
                      <tr>
                          {{#each res}}
                          <td><a href="./repositoryOnto?currentEntity={{escapeEntity .}}">{{.}}</a></td>
                          {{/each}}
                      </tr>
                      {{/each}}
                      </tbody>
                  </table>
              </div>
          </div>
      </div>
      <div role="tabpanel" class="tab-pane" id="MappingViewer">MappingViewer Content</div>
      <div role="tabpanel" class="tab-pane" id="AdminViewer">
    <div class="container">
        <div class="row main-row">
            <div class="8u 12u(mobile)">
                Choisissez une ontologie à afficher <br/><br/>

                <form action="" name="getMetaOntoForm" class="getMetaOntoForm">
                    <select name='ontology'>
                        {{#each listOntos}}
                        <option value={{.}}> {{.}} </option>
                        {{/each}}
                    </select>
                    <button type="submit" name="open" value="open"> Ouvrir et visualiser </button>
                    <button type="submit" name="delete" value="delete"> Supprimer du dépôt</button>
                </form>
            </div>
            <div class="4u 12u(mobile)">
                {{> metadata}}
                <section>
                    <form action="" name="addOntology" class="addOntology">
                        Charger une ontologie : <br/><br/>

                        Format :
                        <select name="format">
                            <option>text/turtle</option>
                            <option>application/x-geoatom+xml</option>
                            <option>text/calendar</option>
                            <option>application/html</option>
                            <option>application/rdf+json</option>
                            <option>application/ld+json</option>
                            <option>application/xhtml+xml</option>
                            <option>application/x-turtle</option>
                            <option>text/n3</option>
                            <option>application/xml</option>
                            <option>text/rdf+n3</option>
                            <option>application/trix</option>
                            <option>text/vcard</option>
                            <option>application/x-trig</option>
                            <option>application/atom+xml</option>
                            <option>application/rss+xml</option>
                            <option>text/plain</option>
                            <option>application/rdf+xml</option>
                            <option>text/html</option>
                            <option>application/x-georss+xml</option>
                        </select><br/>
                        Context / nom du graphe : <input type="text" name="context">
                        {{> uploadOntology}}
                    </form>
                </section>
            </div>

        </div>
    </div>
      </div>
  </div>
</div>

</template>

<template name="metadata">
Métadonnées de l'ontologie : <b> {{ontoSelect}} </b> <br/>
<section>
    <ul>
        {{#each METAS}}
        <li> {{.}} </li>
        {{/each}}
    </ul>
</section>
</template>

<template name="uploadOntology">
<!--{{> upload_bootstrap }}-->
    <input type=file name="ontology"/>
    <button type="submit" value="addOntology"> Ajouter </button>
</template>

<template name="EditorPage">
<style>
.CodeMirror {
    border: 1px solid #eee;
    height:auto;
}
</style>
{{> CodeMirror id="SPARQLQuery" name="SPARQLQuery" options=editorOptions code=editorCode reactiveVar="queryUserSPARQL"}}
</template>
